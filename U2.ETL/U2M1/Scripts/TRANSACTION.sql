CREATE TABLE TRANSACTION(
    PRODUCT_NAME      VARCHAR2(40 BYTE) NOT NULL,
    PRODUCT_DESC      VARCHAR2(40 BYTE),
    CATEGORY_ID       NUMBER(*, 0),
    CATEGORY_NAME     VARCHAR2(40 BYTE),
    CATEGORY_DESC     VARCHAR2(40 BYTE),
    SUBCATEGORY_ID    NUMBER(*, 0),
    SUBCATEGORY_NAME  VARCHAR2(40 BYTE),
    SUBCATEGORY_DESC  VARCHAR2(40 BYTE),
    FEATURE_ID        NUMBER(*, 0),
    FEATURE_NAME      VARCHAR2(40 BYTE),
    FEATURE_DESC      VARCHAR2(40 BYTE),
    PHONE              VARCHAR2(40 BYTE) NOT NULL,
    POSTAL_CODE        NUMBER(10,0) NOT NULL,
    ADDRESS            VARCHAR2(40 BYTE) NOT NULL,
    COUPON_NAME                  VARCHAR2(40) NOT NULL,
    COUPON_DESC                  VARCHAR2(40),
    MEDIA_TYPE_ID                NUMBER(*,0) NOT NULL,
    MEDIA_TYPE                   VARCHAR2(40) NOT NULL,
    DISCOUNT_PERCENTAGE_AMOUNT   NUMBER(4,2) NOT NULL,
    VALID_FROM                   DATE NOT NULL ,
    VALID_TO                     DATE NOT NULL,
    COUNTRY_NAME         CHAR(40),
    REGION_NAME          CHAR(40),
    CITY_NAME            CHAR(40),
    PERIOD_NAME VARCHAR2(20),
    PERIOD_DESC VARCHAR2(40),
    BEGIN_DT    DATE DEFAULT TO_DATE('01/01/1990', 'DD/MM/YYYY'),
    END_DT      DATE DEFAULT TO_DATE('31/12/9999', 'DD/MM/YYYY'),
    INSERT_DT   DATE
);

INSERT INTO TRANSACTION(PRODUCT_NAME, PRODUCT_DESC, CATEGORY_ID,
                        CATEGORY_NAME, CATEGORY_DESC, SUBCATEGORY_ID, SUBCATEGORY_NAME, SUBCATEGORY_DESC, FEATURE_ID,
                        FEATURE_NAME, FEATURE_DESC,
                        PHONE, POSTAL_CODE, ADDRESS, COUPON_NAME, COUPON_DESC, MEDIA_TYPE_ID, MEDIA_TYPE,
                        DISCOUNT_PERCENTAGE_AMOUNT, VALID_FROM,
                        VALID_TO, COUNTRY_NAME, REGION_NAME, CITY_NAME, PERIOD_NAME, PERIOD_DESC, BEGIN_DT, END_DT)
SELECT  P.PRODUCT_NAME, PRODUCT_DESC,
        P.CATEGORY_ID, P.CATEGORY_NAME, P.CATEGORY_DESC,
        P.SUBCATEGORY_ID, P.SUBCATEGORY_NAME, P.SUBCATEGORY_DESC,
        P.FEATURE_ID, P.FEATURE_NAME, P.FEATURE_DESC,
        R.PHONE, R.POSTAL_CODE, R.ADDRESS,
        C.COUPON_NAME, C.COUPON_DESC, C.MEDIA_TYPE_ID, C.MEDIA_TYPE, C.DISCOUNT_PERCENTAGE_AMOUNT,C.VALID_FROM,
                        C.VALID_TO, G.COUNTRY_NAME, G.REGION_NAME, G.CITY_NAME, PERIOD.PERIOD_NAME, PERIOD.PERIOD_DESC, PERIOD.BEGIN_DT, PERIOD.END_DT
FROM SA_PRODUCTS_DATA P, SA_COUPONS_DATA C, SA_PERIODS_DATA PERIOD, SA_GEO_DATA G, SA_RESTAURANTS_DATA R
CONNECT BY LEVEL <= 1;